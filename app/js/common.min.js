$(function(){function e(){for(var e=0,t=0,o=0,i=0,a=0;a<w.length;a++)o+=w[a].offsetHeight,i+=w[a].offsetHeight,u[a]=i,g[a]=t,o>v&&(x[t]=a,e+=o-w[a].offsetHeight,p[t]=e,o=w[a].offsetHeight,t++)}function t(){$(".reviews__box").css("overflow","auto");var e=document.querySelector(".reviews__box").offsetWidth-document.querySelector(".reviews__box").clientWidth;$(".reviews__box__comment__text").css("margin-right",e),$(".reviews__box").css("overflow","hidden")}function o(){T&&-1!=b||(h=g[++b]),b==x[p.length-1]-1&&(b=-1,$(".reviews__box").animate({scrollTop:0},1750),k=!1),$(".reviews__box").animate({scrollTop:u[b]},500),T=!1}function i(){y?$(".reviews__box").finish():h<p.length-1&&!y?b=x[++h]:(h=-1,b=-1,$(".reviews__box").animate({scrollTop:0},1750)),T=!0,$(".reviews__box").animate({scrollTop:p[h]},1e3)}function a(){b--,T&&b--,b>=0?(h=g[b],$(".reviews__box").animate({scrollTop:u[b]},800)):-1==b?$(".reviews__box").animate({scrollTop:0},800):($(".reviews__box").animate({scrollTop:p[p.length-1]},1750),b=x[p.length-1]-2,k=!0),T=!1}function n(){--h>=0?(b=x[h],$(".reviews__box").animate({scrollTop:p[h]},1e3)):-1==h?($(".reviews__box").animate({scrollTop:0},1e3),b=-1,h=-1,k=!0):($(".reviews__box").animate({scrollTop:p[p.length-1]},1750),h=p.length-1,b=x[p.length-2]),T=!0}function r(){b=x[++h],$(".play").prop("disabled",!0).addClass("gray");var e=30*(u[b-1]-u[b-2]);e||(e=30*u[b-1]),$(".reviews__box").animate({scrollTop:p[h]},e,"linear"),setTimeout(function(){$(".play").prop("disabled",!1).removeClass("gray")},e)}function s(){p=[],u=[],x={},g={},h=-1,b=-1,C=!1,T=!1,v=document.querySelector(".reviews__box").offsetHeight-m,w=document.querySelectorAll(".reviews__box__comment"),e()}function _(e,t){e.length>=1&&t.length>=1&&($newComment=$(".reviews__box__comment:first").clone().prependTo(".reviews__box"),$(".reviews__box__comment__text__wrapper:first").removeClass("green").removeClass("red").removeClass("gray"),$newComment.children(".reviews__box__comment__name").html(e),$newComment.find(".reviews__box__comment__text").html(t),$(".reviews__box__comment__text__wrapper:first").addClass($(".reviews option:selected").val()),$(".reviews__new-review .name").val(""),$(".reviews__new-review__text").val(""),l()),e.length<1&&$(".reviews__new-review .name").css("border","2px solid #db594f"),t.length<1&&$(".reviews__new-review__text").css("border","2px solid #db594f")}function c(){t(),$(window).width()<=768&&$(window).width()>480?$(".header__logo,.header__contacts").unwrap(".header-left").addClass("unwrapped"):$(window).width()>768&&$(".header__logo,.header__contacts").hasClass("unwrapped")&&$(".header__logo,.header__contacts").wrapAll("<div class='header-left'></div>").removeClass("unwrapped"),$(window).width()<=480&&$(".footer__phone,.footer__mail").wrapAll("<div class='footer__item,footer__left'></div>")}function l(){$(".reviews__box").animate({scrollTop:0},1e3),clearTimeout(H),$(".play,.pause,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!0),H=setTimeout(function(){$(".play,.pause,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!1),s()},5e3)}function d(e){var t=document.createElement("div"),o=document.createElement("div");t.className="text_container",t.style.cssText="position: fixed; z-index: 99; width: 80vw; height: 50vh; background: rgba(6, 188, 188, 0.9); top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 10px; opacity: 0; transition: all 1.5s ease;",o.style.cssText="position: fixed; z-index: 99; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; font-size: 30px; color: #fff; ",o.innerHTML=e,document.body.appendChild(t),document.querySelector(".text_container").appendChild(o),setTimeout(function(){t.style.opacity="1"},100),setTimeout(function(){t.style.opacity="0"},3e3)}$("body").css("opacity","1");var f=getComputedStyle(document.querySelector(".reviews__box")),m=parseInt(f.borderTopWidth),v=document.querySelector(".reviews__box").offsetHeight-m,w=document.querySelectorAll(".reviews__box__comment"),p=[],u=[],h=-1,b=-1,x={},g={},y=($(".reviews__box")[0].scrollHeight,$(".reviews__box").height(),!1),C=!1,T=!1,k=!1;$(".header__nav__item a:first").addClass("active"),$("form").submit(function(){var e=$(this);return $.ajax({type:"POST",url:"../mail.php",data:e.serialize()}).done(function(){d("Спасибо, Ваше сообщение отправлено!"),setTimeout(function(){e.trigger("reset")},1e3)}),!1});var q=$(window).height();$(window).width()<=768&&$(".intro.fullscreen").css({"min-height":q+"px!important","max-height":q+"px!important",height:q+"px!important"}),$(window).scroll(function(){var e=$(window).scrollTop(),t=$("section#about").offset().top,o=$("section#galery").offset().top,i=$("section#price").offset().top,a=o-.3*(o-t),n=i-.3*(i-o),r=$("section#reviews").offset().top,s=r-.2*(r-i),_=$("section#contact").offset().top,c=_-.3*(_-r);e>=t&&e<.7*a?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:first").addClass("active")):e>=a&&e<n?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 1 )").addClass("active")):e>=n&&e<s?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 2 )").addClass("active")):e>=s&&e<c?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 3 )").addClass("active")):e>=c&&($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 4 )").addClass("active"))}),$(".header__nav,.btn-wrapper").on("click","a",function(e){e.preventDefault();var t=$(this).attr("href"),o=$(t).offset().top,i=$("#about").offset().top;$("body,html").animate({scrollTop:o-i},1500)}),$("#my-menu").on("click","a",function(e){e.preventDefault();var t=$(this).attr("href"),o=$(t).offset().top,i=$("#intro").offset().top;$("body,html").animate({scrollTop:o-i},1500)}),t(),setTimeout(function(){$(".play,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!1)},4999),setTimeout(e,5e3),$(".button.forward").on("click",function(){o()}),$(".button.fast-forward").on("click",function(){i()}),$(".button.backward").on("click",function(){a()}),$(".button.fast-backward").on("click",function(){n()}),$(".button.play").on("click",function(){r(),y&&$(this).html("<i class='fa fa-pause' aria-hidden='true'></i>")}),$("#my-menu").mmenu({onClick:{preventDefault:!0},navbar:{titleLink:"anchor"},extensions:["listview-large","fx-panels-slide-up","fx-listitems-drop","border-offset","pagedim-black"],offCanvas:{position:"right"}});var S=$("#my-menu").data("mmenu");$(".hamburger--emphatic").click(function(){S.open(),$(this).addClass("is-active")}),S.bind("close:start",function(e){$(".hamburger--emphatic").removeClass("is-active")}),$("#my-menu .button").click(function(){S.close()}),$(".add_review").on("click",function(){_($(".reviews__new-review .name").val(),$(".reviews__new-review__text").val())}),$(".reviews__new-review__text, .reviews__new-review .name ").focus(function(){$(this).css("border","none")}),$(window).on("orientationchange",function(){l()}),$(window).resize(function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||l()});var H;$(window).on("resize",function(){c()})});