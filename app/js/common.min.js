$(function(){function e(){for(var e=0,o=0,t=0,n=0,a=0;a<h.length;a++)t+=h[a].offsetHeight,n+=h[a].offsetHeight,p[a]=n,y[a]=o,t>v&&(x[o]=a,e+=t-h[a].offsetHeight,u[o]=e,t=h[a].offsetHeight,console.log(a+" 2 "+t),o++)}function o(){$(".reviews__box").css("overflow","auto");var e=document.querySelector(".reviews__box").offsetWidth-document.querySelector(".reviews__box").clientWidth;$(".reviews__box__comment__text").css("margin-right",e),$(".reviews__box").css("overflow","hidden")}function t(){I&&-1!=b||(g=y[++b]),b==x[u.length-1]-1&&(b=-1,$(".reviews__box").animate({scrollTop:0},1750),S=!1),$(".reviews__box").animate({scrollTop:p[b]},500),console.log("comOptIndex: "+g),console.log("comIndex: "+b),I=!1}function n(){C?$(".reviews__box").finish():g<u.length-1&&!C?b=x[++g]:(g=-1,b=-1,$(".reviews__box").animate({scrollTop:0},1750)),C||$(".reviews__box").animate({scrollTop:u[g]},1e3),console.log("comOptIndex: "+g),console.log("comIndex: "+b),C=!1,I=!0}function a(){b--,I&&b--,b>=0?(g=y[b],$(".reviews__box").animate({scrollTop:p[b]},800),console.log("comOptIndex: "+g),console.log("comIndex: "+b)):-1==b?$(".reviews__box").animate({scrollTop:0},800):($(".reviews__box").animate({scrollTop:u[u.length-1]},1750),b=x[u.length-1]-2,S=!0),I=!1}function i(){--g>=0?(b=x[g],$(".reviews__box").animate({scrollTop:u[g]},1e3),console.log("comOptIndex: "+g),console.log("comIndex: "+b)):-1==g?($(".reviews__box").animate({scrollTop:0},1e3),b=-1,g=-1,S=!0,console.log("comOptIndex: "+g),console.log("comIndex: "+b),console.log("afterSuperScroll: "+S)):($(".reviews__box").animate({scrollTop:u[u.length-1]},1750),g=u.length-1,b=x[u.length-2]),I=!0}function r(){C?(k=!0,C=!1):k&&(k=!1,C=!0),k||(b=x[++g]);var e=30*(p[b-1]-p[b-2]);e||(e=30*p[b-1]),C?$(".reviews__box").stop():$(".reviews__box").animate({scrollTop:u[g]},e,"linear"),C=!0,console.log("speed "+e),console.log("comOptIndex: "+g),console.log("comIndex: "+b),setTimeout(function(){C=!1},e)}function s(){u=[],p=[],x={},y={},g=-1,b=-1,T=!1,I=!1;document.querySelector(".reviews__box").offsetHeight,document.querySelectorAll(".reviews__box__comment");e()}function l(e,o){e.length>=1&&o.length>=1&&($newComment=$(".reviews__box__comment:first").clone().prependTo(".reviews__box"),$(".reviews__box__comment__text__wrapper:first").removeClass("green").removeClass("red").removeClass("gray"),$newComment.children(".reviews__box__comment__name").html(e),$newComment.find(".reviews__box__comment__text").html(o),$(".reviews__box__comment__text__wrapper:first").addClass($(".reviews option:selected").val()),$(".reviews__new-review .name").val(""),$(".reviews__new-review__text").val("")),e.length<1&&$(".reviews__new-review .name").css("border","2px solid #db594f"),o.length<1&&$(".reviews__new-review__text").css("border","2px solid #db594f")}function c(){m(),o(),$(window).width()<=768&&$(window).width()>480?$(".header__logo,.header__contacts").unwrap(".header-left").addClass("unwrapped"):$(window).width()>768&&$(".header__logo,.header__contacts").hasClass("unwrapped")&&$(".header__logo,.header__contacts").wrapAll("<div class='header-left'></div>").removeClass("unwrapped"),$(window).width()<=480&&$(".footer__phone,.footer__mail").wrapAll("<div class='footer__item,footer__left'></div>")}function _(){$(".reviews__box").animate({scrollTop:0},1e3),clearTimeout(O),$(".play,.pause,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!0),O=setTimeout(d,3e3)}function d(){$(".play,.pause,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!1),s()}function m(){var e=$(".galery__item a img").height()+"px";$(".a-after").css("height",e)}$("body").css("opacity","1");var w=getComputedStyle(document.querySelector(".reviews__box")),f=parseInt(w.borderTopWidth),v=document.querySelector(".reviews__box").offsetHeight-f,h=document.querySelectorAll(".reviews__box__comment"),u=[],p=[],g=-1,b=-1,x={},y={},C=($(".reviews__box")[0].scrollHeight,$(".reviews__box").height(),!1),k=!1,T=!1,I=!1,S=!1;$("form").submit(function(){var e=$(this);return $.ajax({type:"POST",url:"../mail.php",data:e.serialize()}).done(function(){alert("Thank you!"),setTimeout(function(){e.trigger("reset")},1e3)}),!1});var q=$(window).height();$(window).width()<=768&&$(".intro.fullscreen").css({"min-height":q+"px!important","max-height":q+"px!important",height:q+"px!important"}),$(window).scroll(function(){var e=$(window).scrollTop(),o=$("section#intro").offset().top,t=$("section#about").offset().top,n=$("section#galery").offset().top,a=n-.3*(n-t),i=$("section#reviews").offset().top,r=i-.3*(i-n),s=$("section#contact").offset().top,l=s-.3*(s-i);e>=o&&e<.7*t?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:first").addClass("active")):e>=.7*t&&e<a?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 1 )").addClass("active")):e>=a&&e<r?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 2 )").addClass("active")):e>=r&&e<l?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 3 )").addClass("active")):e>=l&&($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 4 )").addClass("active")),$introHeight=$(".intro").outerHeight(),$(window).scrollTop()>.65*$introHeight&&$(document).width()>768?$(".about__content").show(700):$(".about__content").hide(700),$(document).width()<768&&$(".about.fullscreen").css("height","auto")}),$(".header__nav,.btn-wrapper").on("click","a",function(e){e.preventDefault();var o=$(this).attr("href"),t=$(o).offset().top,n=$("#intro").offset().top;$("body,html").animate({scrollTop:t-n},1500)}),$("#my-menu").on("click","a",function(e){e.preventDefault();var o=$(this).attr("href"),t=$(o).offset().top,n=$("#intro").offset().top;$("body,html").animate({scrollTop:t-n},1500)}),o(),setTimeout(function(){$(".play,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!1)},4999),setTimeout(e,5e3),$(".button.forward").on("click",function(){t()}),$(".button.fast-forward").on("click",function(){n()}),$(".button.backward").on("click",function(){a()}),$(".button.fast-backward").on("click",function(){i()}),$(".button.play").on("click",function(){r(),C&&$(this).html("<i class='fa fa-pause' aria-hidden='true'></i>")}),$("#calendar").fullCalendar({googleCalendarApiKey:"AIzaSyAmckkTJxLGZoqR_ajjKaRtYnaX4oCVX8Y",events:{googleCalendarId:"1kpbrqup8i1upe1s26gnqaddi4@group.calendar.google.com"},firstDay:1,height:600,header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},monthNames:["Январь","Февраль","Март","Апрель","Май","οюнь","οюль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв.","Фев.","Март","Апр.","Май","οюнь","οюль","Авг.","Сент.","Окт.","Ноя.","Дек."],dayNames:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],dayNamesShort:["ВС","ПН","ВТ","СР","ЧТ","ПТ","СБ"],buttonText:{prev:"◀",next:"▶",prevYear:"&nbsp;&lt;&lt;&nbsp;",nextYear:"&nbsp;&gt;&gt;&nbsp;",today:"Сегодня",month:"Месяц",week:"Неделя",day:"День"},textColor:"black",color:"black"}),$(".intro__calendar").hide(),$(".open-calendar-button").on("click",function(){$(".shadow").toggleClass("modal_shadow"),$(".intro__calendar").css("z-index","6").fadeToggle("slow"),$(".shadow").hasClass("modal_shadow")&&$(".shadow").on("click",function(){$(event.target).closest(".intro_calendar").length||($(".shadow").removeClass("modal_shadow"),$(".intro__calendar").fadeOut("slow"))})}),$("#my-menu").mmenu({onClick:{preventDefault:!0},navbar:{titleLink:"anchor"},extensions:["listview-large","fx-panels-slide-up","fx-listitems-drop","border-offset","pagedim-black"],offCanvas:{position:"right"}});var H=$("#my-menu").data("mmenu");$(".hamburger--emphatic").click(function(){H.open(),$(this).addClass("is-active")}),H.bind("close:start",function(e){$(".hamburger--emphatic").removeClass("is-active")}),$("#my-menu .button").click(function(){H.close()}),$(".add_review").on("click",function(){l($(".reviews__new-review .name").val(),$(".reviews__new-review__text").val())}),$(".reviews__new-review__text, .reviews__new-review .name ").focus(function(){$(this).css("border","none")});var O;$(window).on("orientationchange",function(){_()}),$(window).resize(function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||_()}),$(window).on("resize",function(){c()})});