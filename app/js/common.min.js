$(function(){function e(){for(var e=0,t=0,o=0,a=0,i=0;i<p.length;i++)o+=p[i].offsetHeight,a+=p[i].offsetHeight,w[i]=a,g[i]=t,o>m&&(x[t]=i,e+=o-p[i].offsetHeight,v[t]=e,o=p[i].offsetHeight,t++)}function t(){$(".reviews__box").css("overflow","auto");var e=document.querySelector(".reviews__box").offsetWidth-document.querySelector(".reviews__box").clientWidth;$(".reviews__box__comment__text").css("margin-right",e),$(".reviews__box").css("overflow","hidden")}function o(){k&&-1!=b||(h=g[++b]),b==x[v.length-1]-1&&(b=-1,$(".reviews__box").animate({scrollTop:0},1750),C=!1),$(".reviews__box").animate({scrollTop:w[b]},500),k=!1}function a(){y?$(".reviews__box").finish():h<v.length-1&&!y?b=x[++h]:(h=-1,b=-1,$(".reviews__box").animate({scrollTop:0},1750)),k=!0,$(".reviews__box").animate({scrollTop:v[h]},1e3)}function i(){b--,k&&b--,b>=0?(h=g[b],$(".reviews__box").animate({scrollTop:w[b]},800)):-1==b?$(".reviews__box").animate({scrollTop:0},800):($(".reviews__box").animate({scrollTop:v[v.length-1]},1750),b=x[v.length-1]-2,C=!0),k=!1}function n(){--h>=0?(b=x[h],$(".reviews__box").animate({scrollTop:v[h]},1e3)):-1==h?($(".reviews__box").animate({scrollTop:0},1e3),b=-1,h=-1,C=!0):($(".reviews__box").animate({scrollTop:v[v.length-1]},1750),h=v.length-1,b=x[v.length-2]),k=!0}function r(){b=x[++h],$(".play").prop("disabled",!0).addClass("gray");var e=30*(w[b-1]-w[b-2]);e||(e=30*w[b-1]),$(".reviews__box").animate({scrollTop:v[h]},e,"linear"),setTimeout(function(){$(".play").prop("disabled",!1).removeClass("gray")},e)}function s(){v=[],w=[],x={},g={},h=-1,b=-1,T=!1,k=!1,m=document.querySelector(".reviews__box").offsetHeight-u,p=document.querySelectorAll(".reviews__box__comment"),e()}function c(){_("Приносим свои извенения, эта функция находится в разработке. Пока что, оставить отзыв вы можете на страничке Вконтакте",5)}function l(){t(),$(window).width()<=768&&$(window).width()>480?$(".header__logo,.header__contacts").unwrap(".header-left").addClass("unwrapped"):$(window).width()>768&&$(".header__logo,.header__contacts").hasClass("unwrapped")&&$(".header__logo,.header__contacts").wrapAll("<div class='header-left'></div>").removeClass("unwrapped"),$(window).width()<=480&&$(".footer__phone,.footer__mail").wrapAll("<div class='footer__item,footer__left'></div>")}function d(){$(".reviews__box").animate({scrollTop:0},1e3),clearTimeout(H),$(".play,.pause,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!0),H=setTimeout(function(){$(".play,.pause,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!1),s()},5e3)}function _(e,t){var o=document.createElement("div"),a=document.createElement("div");o.className="text_container",o.style.cssText="position: fixed; z-index: 99; width: 80vw; height: 50vh; background: rgba(6, 188, 188, 0.9); top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 10px; opacity: 0; transition: all 1.5s ease;",a.style.cssText="position: fixed; z-index: 99; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; font-size: 30px; color: #fff; ",a.innerHTML=e,document.body.appendChild(o),document.querySelector(".text_container").appendChild(a),setTimeout(function(){o.style.opacity="1"},100),setTimeout(function(){o.style.opacity="0",setTimeout(function(){o.remove()},1010)},1e3*t)}$("body").css("opacity","1");var f=getComputedStyle(document.querySelector(".reviews__box")),u=parseInt(f.borderTopWidth),m=document.querySelector(".reviews__box").offsetHeight-u,p=document.querySelectorAll(".reviews__box__comment"),v=[],w=[],h=-1,b=-1,x={},g={},y=($(".reviews__box")[0].scrollHeight,$(".reviews__box").height(),!1),T=!1,k=!1,C=!1;$(".header__nav__item a:first").addClass("active"),$("form").submit(function(){var e=$(this);return $.ajax({type:"POST",url:"../mail.php",data:e.serialize()}).done(function(){_("Спасибо, Ваше сообщение отправлено!",3),setTimeout(function(){e.trigger("reset")},1e3)}),!1});var q=$(window).height();$(window).width()<=768&&$(".intro.fullscreen").css({"min-height":q+"px!important","max-height":q+"px!important",height:q+"px!important"}),$(window).scroll(function(){var e=$(window).scrollTop(),t=$("section#about").offset().top,o=$("section#galery").offset().top,a=$("section#price").offset().top,i=o-.3*(o-t),n=a-.3*(a-o),r=$("section#reviews").offset().top,s=r-.2*(r-a),c=$("section#contact").offset().top,l=c-.3*(c-r);e>=t&&e<.7*i?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:first").addClass("active")):e>=i&&e<n?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 1 )").addClass("active")):e>=n&&e<s?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 2 )").addClass("active")):e>=s&&e<l?($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 3 )").addClass("active")):e>=l&&($(".header__nav__item a").removeClass("active"),$(".header__nav__item a:eq( 4 )").addClass("active"))}),$(".header__nav,.btn-wrapper").on("click","a",function(e){e.preventDefault();var t=$(this).attr("href"),o=$(t).offset().top,a=$("#about").offset().top;$("body,html").animate({scrollTop:o-a},1500)}),$("#my-menu").on("click","a",function(e){e.preventDefault();var t=$(this).attr("href"),o=$(t).offset().top,a=$("#about").offset().top;$("body,html").animate({scrollTop:o-a},1500)}),t(),setTimeout(function(){$(".play,.backward,.forward,.fast-forward,.fast-backward").prop("disabled",!1)},4999),setTimeout(e,5e3),$(".button.forward").on("click",function(){o()}),$(".button.fast-forward").on("click",function(){a()}),$(".button.backward").on("click",function(){i()}),$(".button.fast-backward").on("click",function(){n()}),$(".button.play").on("click",function(){r(),y&&$(this).html("<i class='fa fa-pause' aria-hidden='true'></i>")}),$("#my-menu").mmenu({onClick:{preventDefault:!0},navbar:{titleLink:"anchor"},extensions:["listview-large","fx-panels-slide-up","fx-listitems-drop","border-offset","pagedim-black"],offCanvas:{position:"right"}});var S=$("#my-menu").data("mmenu");$(".hamburger--emphatic").click(function(){S.open(),$(this).addClass("is-active")}),S.bind("close:start",function(e){$(".hamburger--emphatic").removeClass("is-active")}),$("#my-menu .button").click(function(){S.close()}),$(".add_review").on("click",function(){c()}),$(".reviews__new-review__text, .reviews__new-review .name ").focus(function(){$(this).css("border","none")}),$(window).on("orientationchange",function(){d()}),$(window).resize(function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||d()});var H;$(window).on("resize",function(){l()})});